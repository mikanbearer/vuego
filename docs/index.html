<!DOCTYPE html>
<html><head>
	<meta name="generator" content="Hugo 0.82.0" />
  <meta charset="UTF-8">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="author" content="Zhang San">
  <title>活到老學到死</title>

  
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@5.x/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <link href="https://mikanbearer.github.io/vuego/css/code-block.css" rel="stylesheet">
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    
  <style>
    [v-cloak] {
      display: none;
    }

    .keyword-input label {
      margin-top: -4px;
    }

    .site-title {
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif !important;
    }
 
    .post-title {
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif !important;
      font-weight: 500;
      white-space: normal;
      overflow-wrap: break-word;
    }

    .post-subtitle {
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif !important;
      font-weight: 400;
      text-transform: none;
    }

    .post-content {
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif !important;
      font-weight: 300;
    }

    .post-card .post-title {
      color: #eeeeee;
    }

    .overline .post-subtitle {
      letter-spacing: .1em !important;
    }

    body {
      width: 100%;
      height: 100%;
      background-attachment: fixed;
      top: 0;
      left: 0;
      background-size: cover;
      background-color: #272727;
    }

    a {
      text-decoration:none;
    }
  
    #inspire {
      background: none;
    }

    a.v-chip--active.accent {
      -webkit-filter: brightness(1.1);
    }

    span.v-chip__content {
      font-family: Roboto,sans-serif !important;
      font-weight: 500;
    }

    a.v-chip--active.accent span {
      color: #ffffff;
    }

    img {
      max-width: 100%;
    }

  </style>
</head>
  <body><div id="content">
<div id="app" v-cloak>
  <v-app id="inspire">
      <v-app-bar
        app
        fade-img-on-scroll
        hide-on-scroll
        v-model="appBar"
        src="https://mikanbearer.github.io/vuego/img/0.jpg"    
      >

      

      <v-toolbar-title class="mr-12 align-center">
        <span class="site-title">活到老學到死</span>
      </v-toolbar-title>

      <v-spacer></v-spacer>

      <v-tooltip bottom>
        <template v-slot:activator="{ on, attrs }">
          <v-btn
            @click.stop="filterModal = !filterModal"
            v-bind="attrs"
            v-on="on"
            icon
          >
            <v-icon v-if="notInFilter">mdi-filter-outline</v-icon>
            <v-icon v-else color="error lighten-1">mdi-filter</v-icon>
          </v-btn>
        </template>
        <span>Filter posts by title, category and tag</span>
      </v-tooltip>
  
      <template v-slot:img="{ props }">
        <v-img
          v-bind="props"
          gradient="to top right, rgba(31,49,52,.7), rgba(69,87,101,.7)"
        ></v-img>
      </template>
    
    
      <template v-slot:extension>
        <v-tabs align-with-title>
          <v-tab v-if="$route.path == '/'"  to="/" :class="['v-tab--active']">Posts</v-tab>
          <v-tab v-else to="/">Posts</v-tab>
          <v-tab to="/works">Works</v-tab>
          <v-tab to="/about">About</v-tab>
        </v-tabs>
      </template>
    
    </v-app-bar>

    <v-main>
      <v-container style="min-height: 100vh;">
        <v-row no-gutters>
          <v-col cols="12">
          
            <router-view></router-view>
        
          </v-col>
        </v-row>

        <v-row no-gutters>
          <v-col cols="12">
            <disqus-card :comment-block="commentBlock"></disqus-card>
          </v-col>
        </v-row>
      </v-container>
    </v-main>

    <v-footer padless color="transparent">
      <v-col
        class="text-center text-body-2 grey--text text--lighten-1"
        cols="12"
      >
        <div>
          2020 — 
          
          Zhang San
          
        </div>
        <div>
          Powered by Hugo 0.82.0
        </div>
      </v-col>
    </v-footer>


    <v-dialog v-model="filterModal" max-width="600">
      <filter-card></filter-card>
    </v-dialog>

  </v-app>
</div>

        </div>
<script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
<script src="https://cdn.jsdelivr.net/npm/echarts@4.9.0/dist/echarts.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script type="text/x-template" id="filter-card">
    <v-card color="grey darken-3">
        <v-card-title>
            Filter Posts
        </v-card-title>
        <v-card-text>

            <v-combobox 
                :search-input.sync="filterConditions.keyword"
                :items="getItems(filterConditions.keyword, filterSelections.titles)"
                clearable
                hide-selected
                hide-details
                prepend-inner-icon="mdi-magnify"
                label="Title"
                height="42"
                menu-props="light"
                class="keyword-input"
            >  
            </v-combobox>

            <v-combobox 
                v-model="filterConditions.selectedCategories"
                :items="filterSelections.categories"
                chips
                clearable
                multiple
                hide-selected
                hide-details
                prepend-inner-icon="mdi-folder-multiple"
                label="Categories"
                height="42"
                menu-props="light"
                :delimiters="[',']"
            >  
                <template v-slot:selection="{ attrs, item, select, selected }">
                    <v-chip
                        v-bind="attrs"
                        :input-value="selected"
                        close
                        @click:close="removeItem('selectedCategories', item)"
                    >
                        [[ item ]]
                    </v-chip>
                </template>       
            </v-combobox>

            <v-combobox 
                v-model="filterConditions.selectedTags"
                :items="filterSelections.tags"
                chips
                clearable
                multiple
                hide-selected
                hide-details
                prepend-inner-icon="mdi-tag-multiple"
                label="Tags"
                menu-props="light"
                :delimiters="[',']"
            >
                <template v-slot:selection="{ attrs, item, select, selected }">
                    <v-chip
                        color="accent"
                        v-bind="attrs"
                        :input-value="selected"
                        close
                        @click:close="removeItem('selectedTags', item)"
                    >
                        [[ item ]]
                    </v-chip>
                </template>              
            </v-combobox>

        </v-card-text>
    
        <v-card-actions>
            <v-spacer></v-spacer>
            <v-btn
                :disabled="notInFilter"
                color="error"
                @click="$router.history.push('/')"
                small
            >
                Clear
            </v-btn>
            <v-btn color="primary" @click="toFilteredPosts" small>
                Filter
            </v-btn>
        </v-card-actions>
    </v-card>
</script>
<script type="text/x-template" id="post-card">
    <v-slide-x-transition>
        <div v-show="isLoaded">
    
            <div class="mb-6">
                <v-card class="post-card" v-if="post" color="#333a40">
                    <v-list-item three-line>
                        <v-list-item-content>
                        
                            <div class="overline">
                                <div class="post-subtitle grey--text">
                                    <v-icon small color="grey lighten-1">
                                        mdi-calendar
                                    </v-icon>
                                    [[ post.params.date.slice(0,10) ]]
                                    <v-divider vertical></v-divider>
                                    <v-icon small color="grey lighten-1">
                                        mdi-folder-multiple
                                    </v-icon>
                                    <div v-for="(category, index) in post.params.categories" class="d-inline">
                                        <span v-if="index">, </span>
                                        <router-link
                                            :to="{path: '/', query: {category: category}}"
                                        >
                                            [[ category ]]
                                        </router-link>
                                    </div>
                                </div>
                            </div>
                        
                        
                        
                            <v-list-item-title class="text-h6 grey--text text--lighten-2">
                                <router-link 
                                    class="post-title" 
                                    v-html="post.params.title" 
                                    :to="{name: 'post', params: {path: post.path}}"
                                    v-if="post.summary"
                                >
                                </router-link>
                                <span 
                                    class="post-title"
                                    v-else
                                >
                                    [[ post.params.title ]]
                                </span>
                            </v-list-item-title>
                        
                            <v-list-item-subtitle>
                                <div class="mt-2 text-body-2 grey--text text--lighten-1">
                                
                                    <div v-if="$router.path == '/'" class="post-subtitle">
                                        <v-icon small color="grey lighten-1">
                                            mdi-tag-multiple
                                        </v-icon>
                                        <div v-for="tag in post.params.tags" class="d-inline">
                                            <v-chip
                                                color="accent"
                                                label
                                                text-color="grey lighten-3"
                                                x-small
                                                class="mr-1"
                                                :key="tag"
                                                :to="{path: '/', query: {tag: tag}}"
                                                v-if="searchConditions.selectedTags.includes(tag)"
                                                :class="['v-chip--active']"
                                            >
                                                [[ tag ]]
                                            </v-chip>
                                            <v-chip
                                                color="accent"
                                                label
                                                text-color="grey lighten-3"
                                                x-small
                                                class="mr-1"
                                                :key="tag"
                                                :to="{path: '/', query: {tag: tag}}"
                                                v-else
                                            >
                                                [[ tag ]]
                                            </v-chip>
                                        </div>
                                    </div>
                                
                                    <div v-else class="post-subtitle">
                                        <v-icon small color="grey lighten-1">
                                            mdi-tag-multiple
                                        </v-icon>
                                        <div v-for="tag in post.params.tags" class="d-inline">
                                            <v-chip
                                                color="accent"
                                                label
                                                text-color="grey lighten-3"
                                                x-small
                                                class="mr-1"
                                                :key="tag"
                                                :to="{path: '/', query: {tag: tag}}"
                                            >
                                                [[ tag ]]
                                            </v-chip>
                                        </div>
                                    </div>    
                                
                                </div>                      
                            </v-list-item-subtitle>
                        </v-list-item-content>
                    </v-list-item>
                
                    <v-divider inset></v-divider>
                
                    <v-card-text v-if="post.content" class="text-body-2 grey--text text--lighten-2">
                        <div class="post-content" v-html="post.content"></div>
                    </v-card-text>
                
                    <v-card-text v-else-if="post.summary" class="text-body-2 grey--text text--lighten-2">
                        <div class="post-content" v-html="post.summary"></div>
                        <v-row justify="end">
                            <v-tooltip bottom>
                                <template v-slot:activator="{ on, attrs }">
                                    <div
                                        v-bind="attrs"
                                        v-on="on"
                                    >
                                        <v-btn :to="{name: 'post', params: {path: post.path}}" color="primary" small text>
                                            Continue Reading
                                            <v-icon right small>
                                                mdi-chevron-right
                                            </v-icon>
                                        </v-btn>
                                    </div>
                                </template>
                                <span>[[ post.wordcount ]] words</span>
                            </v-tooltip> 
                        </v-row>
                    </v-card-text>
                
                </v-card>
            </div>

        </div>
    </v-slide-x-transition>
</script>
<script type="text/x-template" id="disqus-card">
    <v-card v-show="commentBlock" color="#333a40">
        <v-card-text>
          <div id="disqus_thread"></div>
          <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </v-card-text>
      </v-card>
</script>
<script type="text/x-template" id="posts">

    <div v-show="displayPosts.length" class="post-list">

        <v-row v-if="$vuetify.breakpoint.lg || $vuetify.breakpoint.xl">
            <v-col cols="4">
                <div v-for="(post, index) in displayPosts" :key="index">
                    <div v-if="index % 3 === 0">
                        <post-card :post="post" :is-loaded="showPostList.includes(index)"></post-card>
                    </div>
                </div>
            </v-col>
            <v-col cols="4">
                <div v-for="(post, index) in displayPosts" :key="index">
                    <div v-if="index % 3 === 1">
                        <post-card :post="post" :is-loaded="showPostList.includes(index)"></post-card>
                    </div>
                </div>
            </v-col>
            <v-col cols="4">
                <div v-for="(post, index) in displayPosts" :key="index">
                    <div v-if="index % 3 === 2">
                        <post-card :post="post" :is-loaded="showPostList.includes(index)"></post-card>
                    </div>
                </div>
            </v-col>
        </v-row>

        <v-row v-if="$vuetify.breakpoint.sm || $vuetify.breakpoint.md">
            <v-col cols="6">
                <div v-for="(post, index) in displayPosts" :key="index">
                    <div v-if="index % 2 === 0">
                        <post-card :post="post" :is-loaded="showPostList.includes(index)"></post-card>
                    </div>
                </div>
            </v-col>
            <v-col cols="6">
                <div v-for="(post, index) in displayPosts" :key="index">
                    <div v-if="index % 2 === 1">
                        <post-card :post="post" :is-loaded="showPostList.includes(index)"></post-card>
                    </div>
                </div>
            </v-col>
        </v-row>

        <v-row v-if="$vuetify.breakpoint.xs">
            <v-col cols="12">
                <div v-for="(post, index) in displayPosts" :key="index">
                    <div>
                        <post-card :post="post" :is-loaded="showPostList.includes(index)"></post-card>
                    </div>
                </div>
            </v-col>
        </v-row>


        <v-row no-gutters justidy="center">
            <v-col>
                <v-slide-x-transition>
                    <v-pagination v-show="showPostList.length === pageSize" v-model="page" :length=pageLength @input="pageChange" class="mt-4"></v-pagination>
                </v-slide-x-transition>
            </v-col>
        </v-row>
    

        <v-snackbar
            v-model="resultSnackbar"
            :timeout=2000
        >
            Found [[ filteredPosts.length ]] Posts.
            <template v-slot:action="{ attrs }">
                <v-btn
                    color="primary"
                    icon
                    v-bind="attrs"
                    @click="resultSnackbar = false"
                >
                    <v-icon>
                        mdi-close
                    </v-icon>
                </v-btn>
            </template>
        </v-snackbar>
    </div>

</script>
<script type="text/x-template" id="post">
    <v-row v-if="post.content" >
        <v-col>
            <post-card :post="post" :is-loaded="isLoaded"></post-card>
        </v-col>
    </v-row>
</script>
<script type="text/x-template" id="works">
    <div v-if="works">
        <v-row justify="center" class="mt-n5">
            <v-col>
                <transition-group name="fade" tag="p">

                    <div v-for="(work, index) in works" :key="work.name">
                        <v-card flat color="transparent">
                            <v-card-text>
                                <v-row>
                                    <v-col xs="12" sm="6" md="6" lg="4" xl="4">
                                        <v-card height="100%" flat color="transparent">
                                            <v-card-text>
                                                <v-carousel hide-delimiters height="240">
                                                    <v-carousel-item
                                                        v-for="(item, i) in work.params.images"
                                                        :key="i"
                                                        :src="item"
                                                    >
                                                    </v-carousel-item>
                                                </v-carousel>
                                            </v-card-text>
                                        </v-card>
                                    </v-col>
                                
                                    <v-col xs="12" sm="6" md="6" lg="8" xl="8">
                                        <v-card height="100%" flat color="transparent">
                                            <v-card-title class="text-h6 grey--text text--lighten-3">
                                                <span class="post-title">
                                                    [[ work.params.title ]]
                                                </span>
                                            </v-card-title>
                                            <v-card-subtitle>
                                                [[ work.params.date.slice(0,10) ]]
                                                <span v-for="tag in work.params.tags" class="warning--text text--lighten-3"> #[[ tag ]]</span>
                                            </v-card-subtitle>
                                        
                                            <v-card-text class="text-body-2 grey--text text--lighten-2" style="margin-bottom: 1rem">
                                                <div class="post-content" v-html="work.content">
                                                </div>
                                            </v-card-text>

                                            <v-card-actions style="padding: 0px 16px 0px 16px; position: absolute; bottom: 1rem;">
                                                <v-btn
                                                    :href="work.params.demo_url" 
                                                    :disabled="!work.params.demo_url" 
                                                    target="_blank"
                                                    color="secondary"
                                                    small
                                                >
                                                    Demo
                                                </v-btn>
                                                <v-btn
                                                    :href="work.params.download_url"
                                                    :disabled="!work.params.download_url" 
                                                    target="_blank"
                                                    color="primary"
                                                    small
                                                >
                                                    Download
                                                </v-btn>
                                            </v-card-actions>
                                        </v-card>
                                    </v-col>
                                </v-row>
                            </v-card-text>
                        </v-card>
                        <v-divider></v-divider>
                    </div>
            
                </transition-group>
            </v-col>
        </v-row>



    </div>
</script>
<script type="text/x-template" id="about">
    <div>
        <v-row justify="center" class="mt-n5">
            <v-col cols="12" xs="12" sm="12" md="6" lg="6" xl="6">
                <v-fade-transition>
                    <v-card flat color="transparent" v-show="content">
                        <v-card-title class="text-h6 grey--text text--lighten-3">
                            <span class="post-title">
                                About
                            </span>
                        </v-card-title>
                        <v-card-text class="text-body-2 grey--text text--lighten-2 mt-2">
                            <div class="mr-2 ml-2 post-content" v-html="content">
                            </div>
                        </v-card-text>     
                    </v-card>
                </v-fade-transition>
            </v-col>

            <v-col cols="12" xs="12" sm="12" md="6" lg="6" xl="6">
                <v-fade-transition>
                    <v-card flat color="transparent" v-show="content">
                        <v-card-title class="text-h6 grey--text text--lighten-3">
                            <span class="post-title">
                                Profile
                            </span>
                        </v-card-title>
                        <v-card-text class="text-body-2 grey--text text--lighten-2 mt-2">
                            <div class="mr-2 ml-2 post-content">
                                Name: [[ author.name ]]
                            </div>
                        </v-card-text>

                        <v-card-title class="text-h6 grey--text text--lighten-3">
                            <span class="post-title">
                                Social Links
                            </span>
                        </v-card-title>
                        <v-card-text class="d-flex justify-space-around text-body-2 grey--text text--lighten-2">
                            <v-btn
                                icon
                                :disabled="!author.email"
                                :href="'mailto:' + author.email" 
                            >
                                <v-icon>mdi-email</v-icon>
                            </v-btn>
                        
                            <v-btn
                                icon
                                v-for="(item, index) in author.socialLinks"
                                :key="index"
                                :disabled="!item.user"
                                :href="item.url + item.user"
                                target="_blank"
                            >
                                <v-icon>mdi-[[item.name]]</v-icon>
                            </v-btn>
                        </v-card-text>
                    </v-card>
                </v-fade-transition>
            </v-col>

            <v-col cols="12" xs="12" sm="12" md="6" lg="6" xl="6">
                <v-card flat color="transparent">
                    <v-card-title class="text-h6 grey--text text--lighten-3">
                        <span class="post-title">
                            Categories
                        </span>
                    </v-card-title>
                    <div id="chart_categories" style="width:100%; height:240px;"></div>
                </v-card>
            </v-col>

            <v-col cols="12" xs="12" sm="12" md="6" lg="6" xl="6">
                <v-card flat color="transparent">
                    <v-card-title class="text-h6 grey--text text--lighten-3">
                        <span class="post-title">
                            Tags
                        </span>
                    </v-card-title>
                    <div id="chart_tags" style="width:100%; height:240px;"></div>
                </v-card>
            </v-col>

            <v-col cols="12">
                <v-card flat color="transparent">
                    <v-card-title class="text-h6 grey--text text--lighten-3">
                        <span class="post-title">
                            Monthly Post Count - Last Year
                        </span>
                    </v-card-title>
                    <div id="monthly" style="width:100%; height:240px;"></div>
                </v-card>
            </v-col>

        </v-row>
        

     
    </div>

</script>



<script>
  Vue.component('filter-card', {
    data() {
      return {
        filterSelections: {},
        filterConditions: {},
      }
    },
    template: '#filter-card',
    delimiters: ['[[', ']]'],
    computed: {
      routeQuery () {
        return this.$route.query
      },

      notInFilter () {
        const queryKeys = Object.keys(this.$route.query)
        if (queryKeys.length === 0) {
          return true
        }
        return !queryKeys.every(v => ['keyword', 'category', 'tag'].includes(v))
      }
    },

    mounted () {
      this.getFilterSelections('https:\/\/mikanbearer.github.io\/vuego\/selections/index.json')
      this.setFilterConditionsToData()
    },

    watch: {
      routeQuery () {
        if (this.$route.path == '/') {
          this.setFilterConditionsToData()
        }
      }
    },

    methods: {
      getFilterSelections (url) {
        axios.get(url).then(response => {
          this.filterSelections = response.data.result
        })
      },

      getFilterConditions () {
        let query = this.routeQuery
        const convertToArray = (value) => {
          if (Array.isArray(value)) {
            return value
          } else if (typeof value === 'string') {
            return value.split(',')
          } else {
            return []
          }
        }

        let filterConditions = {}

        filterConditions.selectedCategories = convertToArray(query.category)
        filterConditions.selectedTags = convertToArray(query.tag)
        if (typeof query.keyword === 'string') {
          filterConditions.keyword = query.keyword
        } else {
          filterConditions.keyword = null
        }
        return filterConditions
      },

      setFilterConditionsToData () {
        this.filterConditions = this.getFilterConditions()
      },

      toFilteredPosts () {
        let query = {}

        this.$route.query.keyword = null
        this.$route.query.category = null
        this.$route.query.tag = null

        if (this.filterConditions.keyword) {
          query.keyword = this.filterConditions.keyword
        }
        if (this.filterConditions.selectedCategories.length) {
          query.category = this.filterConditions.selectedCategories
        }
        if (this.filterConditions.selectedTags.length) {
          query.tag = this.filterConditions.selectedTags
        }
        
        this.$router.history.push({
          path: '/',
          query: query
        })

      },

      getItems (key, items) {
        if (key) {
          return items
        }else{
          return []
        }
      },

      removeItem (target, item) {
        const index = this.filterConditions[target].indexOf(item)
        if (index >= 0) {
          this.filterConditions[target].splice(index, 1)
        }
      },
    }
  })

  Vue.component('post-card', {
    props: ['post', 'isLoaded'],
    template: '#post-card',
    delimiters: ['[[', ']]']
  })

  Vue.component('disqus-card', {
    props: ['commentBlock'],
    template: '#disqus-card',
    delimiters: ['[[', ']]'],
    computed: {
      postPath () {
        return this.$route.params.path
      }
    },

    watch: {
      postPath (newPath, oldPath) {
        if (newPath) {
          this.resetDISQUS('https:\/\/mikanbearer.github.io\/vuego\/' + newPath)
        }
      }
    },

    mounted () {
      this.initDISQUS('https:\/\/mikanbearer.github.io\/vuego\/' + this.postPath)
    },

    methods: {
      initDISQUS (disqusPageUrl) {
        (() => {
          window.disqus_config = function () {
            this.page.url = disqusPageUrl
          }
          
          if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.'
            return
        }
        let d = document, s = d.createElement('script')
        s.async = true

        let disqus_shortname = 'mikanmimi'
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js'
        s.setAttribute('data-timestamp', +new Date())
        d.body.appendChild(s)
        })()
      },

      resetDISQUS (disqusPageUrl) {
        if (window.DISQUS) {
          window.DISQUS.reset({
            reload: true,
            config: function () {
              this.page.url = disqusPageUrl
            }
          })
        }
      },

    }
  })

  const About = {
    template: '#about',
    delimiters: ['[[', ']]'],

    data () {
      return {
        content: null,
        author: {
          name: 'Zhang San',
          email:'',
          socialLinks: [
            {
              name: 'github',
              user: '',
              url: 'https://github.com/'
            },
            {
              name: 'gitlab',
              user: '',
              url: 'https://gitlab.com/'
            },
            {
              name: 'codepen',
              user: '',
              url: 'https://codepen.io/'
            },
            {
              name: 'linkedin',
              user: '',
              url: 'https://linkedin.com/in/'
            },
            {
              name: 'twitter',
              user: '',
              url: 'https://twitter.com/'
            },
            {
              name: 'facebook',
              user: '',
              url: 'https://www.facebook.com/'
            },
            {
              name: 'instagram',
              user: '',
              url: 'https://www.instagram.com/'
            },
            {
              name: 'youtube',
              user: '',
              url: 'https://www.youtube.com/user/'
            }
          ]
        }

      }
    },

    created () {
      axios.get('https:\/\/mikanbearer.github.io\/vuego\/about/index.json').then(response => {
          setTimeout(() => {
            this.content = response.data.result.content
            let charts = response.data.result.charts
            
            setTimeout(() => {
              this.setPie('Top Categories', 'category', charts.categories_data, 'chart_categories')
            }, 500)
            setTimeout(() => {
              this.setPie('Top Tags', 'tag', charts.tags_data, 'chart_tags')
            }, 700)
            setTimeout(() => {
              let x = []
              let y = []
              for (let i = 0; i < 12; i++) {
                let month = moment().subtract(i, 'M').format('YYYY-MM')
                x.push(month)
                y.push(charts.monthly_count[month] || 0)
              }
              this.setArea('', x, y, 'monthly')
            }, 1000)
          }, 500)
      })
    },
    methods: {
      setArea (title, x_data, series_data, element_id) {
        option = {
          tooltip: {
            trigger: 'axis',
          },
          xAxis: {
            type: 'category',
            boundaryGap: false,
            data: x_data.reverse(),
          },
          yAxis: {
            type: 'value'
          },
          series: [{
            data: series_data.reverse(),
            type: 'line',
            areaStyle: {}
          }],
          textStyle: {
              color: '#c2c4c6'
          }
        }
        let chart = echarts.init(document.getElementById(element_id))
        chart.setOption(option)
      },

      setPie (title, series_name, data, element_id) {
        let option = {
          title: {
            left: 'auto',
            
            textStyle: {
              color: '#e0e0e0',
              fontSize: 16,
              fontFamily: 'Noto Sans TC'
            }
          },
          tooltip: {
            trigger: 'item',
            formatter: '{b} : {c} ({d}%)'
          },
          legend: {
            type: 'scroll',
            orient: 'vertical',
            right: 0,
            top: 10,
            bottom: 10,
            data: data.legend,
            selected: data.selected,
            inactiveColor: '#686868',
            pageIconColor: '#aaa',
            pageIconInactiveColor: '#2f4554',
            textStyle: {
              color: '#c2c4c6'
            },
            pageTextStyle: {
              color: '#c2c4c6'
            }
          },
          series: [
            {
              name: series_name,
              type: 'pie',
              radius: '55%',
              center: ['40%', '50%'],
              data: data.series,
              emphasis: {
                itemStyle: {
                  shadowBlur: 10,
                  shadowOffsetX: 0,
                  shadowColor: 'rgba(0, 0, 0, 0.5)'
                }
              }
            }
          ]
        }
        let chart = echarts.init(document.getElementById(element_id))
        chart.setOption(option)

      }
    }
  }

  const Works = {
    template: '#works',
    delimiters: ['[[', ']]'],

    data () {
      return {
        works: null
      }
    },

    created () {
      axios.get('https:\/\/mikanbearer.github.io\/vuego\/works/index.json').then(response => {
          setTimeout(() => {this.works = response.data.result.pages}, 300)
      })
    },
  }


  const Post = {
    template: '#post',
    delimiters: ['[[', ']]'],
    props: ['path'],

    data () {
      return {
        post: {},
        isLoaded: false
      }
    },

    mounted () {
      let postUrl = 'https:\/\/mikanbearer.github.io\/vuego\/' + this.path + '/index.json'
      this.getPost(postUrl)
      
    },

    methods: {
      replaceImgSrc () {
        let contents = document.getElementsByClassName('post-content')
        let url = this.post.permalink
        if (url.includes('index.json')) {
          url = url.replace('index.json', '')
        }

        Array.prototype.forEach.call(contents, content => {
          let imgs = content.getElementsByTagName('img')
          Array.prototype.forEach.call(imgs, img => {
            if (img.attributes.src.value.indexOf('http') == -1) {
              img.src = url + img.attributes.src.value
            }
          })
        })        
      },

      addCodeBlockTitle () {
        let code_list = document.body.getElementsByTagName('code')
        for (i=0; i <= code_list.length-1; i++) {
          let codeParent = code_list[i].closest('pre')
          if (codeParent) {
            if (!codeParent.closest('div.highlight')) {
              if (/^language-:+/.test(code_list[i].className)) {
                let div = document.createElement('div')
                div.classList.add('highlight')
                let pre = codeParent.cloneNode(true)
                div.appendChild(pre)
                codeParent.replaceWith(div)
              }
            }
          }
        }

        let list = document.body.getElementsByClassName('highlight')

        for(i=0; i <= list.length-1; i++){
          let table = list[i].firstElementChild.firstElementChild
          if (table.nodeName == 'TABLE') {
            let code = table.firstElementChild.firstElementChild.childNodes[2].firstElementChild.firstElementChild
            let codeName =  code ? code.className.split(':')[1] : null
            if(codeName) {
              let div = document.createElement('div')
              div.textContent = codeName
              div.classList.add('code-name')
              table.parentNode.insertBefore(div, table)
            }
          } else {
            let code = table
            let codeName =  code ? code.className.split(':')[1] : null
          
            if(codeName) {
              let div = document.createElement('div')
              let br = document.createElement('br')
              div.textContent = codeName
              div.classList.add('code-name')
              code.parentNode.insertBefore(div, code)
              code.parentNode.insertBefore(br, code)
            }
          }
        }
      },

      getPost (url) {
        axios.get(url).then(response => {
          this.post = response.data.result
        
          setTimeout(() => {
            this.replaceImgSrc()
            this.addCodeBlockTitle()
          }, 10)

          setTimeout(() => {
            this.isLoaded = true
          }, 50)

        })
      },


    }
  }
  

  const Posts = {
    template: '#posts',
    delimiters: ['[[', ']]'],
    data () {
      return {
        page: 1,
        pageSize: 6,
        pageLength: null,
        postList: [],
        filteredPosts: [],
        displayPosts: [],
        resultSnackbar: false,
        filterConditions: {
          selectedCategories: [],
          selectedTags: [],
          keyword: null
        },
        showPostList: [],
        showFooter: false
      }
    },

    computed: {
      routeQuery () {
        return this.$route.query
      }
    },

    mounted () {
      this.getPostList('https:\/\/mikanbearer.github.io\/vuego\/posts/index.json')
    },

    watch: {
      routeQuery () {
        this.postsInit()
      },
    },

    methods: {
      getPostList (url) {
        axios.get(url).then(response => {
          this.postList = response.data.result.pages
          this.postsInit()
        })
      },

      getFilterConditions () {
        let query = this.routeQuery
        const convertToArray = (value) => {
          if (Array.isArray(value)) {
            return value
          } else if (typeof value === 'string') {
            return value.split(',')
          } else {
            return []
          }
        }

        let filterConditions = {}

        filterConditions.selectedCategories = convertToArray(query.category)
        filterConditions.selectedTags = convertToArray(query.tag)
        if (typeof query.keyword === 'string') {
          filterConditions.keyword = query.keyword
        } else {
          filterConditions.keyword = null
        }
        return filterConditions
      },

      postsInit () {
        if (Object.keys(this.$route.query).length) {
          this.filterPosts()
        }
        else {
          this.filteredPosts = this.postList
          this.pageInit()
        }
      },

      pageChange (pageNumber) {
        this.showPostList = []
        window.scroll({top: 0, behavior: 'instant'})
        setTimeout(() => {
          this.displayPosts = this.filteredPosts.slice(this.pageSize*(pageNumber - 1), this.pageSize*(pageNumber))
          for (i = 0; i < this.pageSize; i++) {
            ((i) => {
              setTimeout(() => {
                this.showPostList.push(i)
              }, i * 170)
            })(i)  
          } 
        }, 180)
        
      },

      pageInit () {
        this.pageLength = Math.ceil(this.filteredPosts.length/this.pageSize)
        this.page = 1
        setTimeout(() => {
          this.pageChange(1)
        }, 50)
        
      },

      filterPosts () {
        let filterConditions = this.getFilterConditions()
        this.filterConditions = filterConditions
        let keyword = filterConditions.keyword
        let selectedTags = filterConditions.selectedTags
        let selectedCategories = filterConditions.selectedCategories
        const posts = JSON.parse(JSON.stringify(this.postList))

        const checkArray = (target, item) => {
          if (item && target) {
            return item.every(v => target.includes(v))
          }
          return false
        }

        let checkArrayResult = []

        for (const post of posts) {
          if (checkArray(post.params.tags, selectedTags) && checkArray(post.params.categories, selectedCategories)) {
            checkArrayResult.push(post)
          }
        }

        let checkKeywordResult = []

        if (keyword) {
          let lower_keyword = keyword.toLowerCase()
          for (const post of checkArrayResult) {
            let lower_title = post.params.title.toLowerCase()
            let keywordIndex = lower_title.indexOf(lower_keyword)

            if (keywordIndex !== -1) {
              hl_keyword = '<span style="background-color:#00a381">' + post.params.title.substring(keywordIndex, keywordIndex + keyword.length) + '</span>'
              post.params.title = lower_title.replace(lower_keyword, hl_keyword)
              checkKeywordResult.push(post)
            }
          }
          this.filteredPosts = checkKeywordResult
        } else {
          this.filteredPosts = checkArrayResult
        }
        this.resultSnackbar = true
        this.pageInit()
      },
    }
  }

  const routes = [
    { path: '/', name: 'main', component: Posts },
    { path: '/posts/:path', name: 'post', component: Post, props: true },
    { path: '/works', name: 'works', component: Works },
    { path: '/about', name: 'about', component: About }
  ]

  const router = new VueRouter({
    routes
  })


  
  router.afterEach((to, from) => {
    window.scroll({top: 0, behavior: 'instant'})
  })


  

  const vm = new Vue({
    router,
    delimiters: ['[[', ']]'],
    el: '#app',
    vuetify: new Vuetify(),
    data: {
      filterModal: false,
      commentBlock: false,
      appBar: true
    },

    computed: {
      notInFilter () {
        const queryKeys = Object.keys(this.$route.query)
        if (queryKeys.length === 0) {
          return true
        }
        return !queryKeys.every(v => ['keyword', 'category', 'tag'].includes(v))
      }
    },

    created () {
      this.$vuetify.theme.themes.dark.primary = '#F08300'
      this.$vuetify.theme.themes.dark.secondary = '#006e54'
      this.$vuetify.theme.themes.dark.warning = '#d3381c'
      this.$vuetify.theme.themes.dark.error = '#D7003A'
      this.$vuetify.theme.themes.dark.accent = '#009988'
      this.$vuetify.theme.themes.dark.header = '#1f3134'
      this.$vuetify.theme.themes.dark.content = '#333a40'
      this.$vuetify.theme.dark = true
    },

    mounted () {
      this.showComment()
    },

    updated () {
      this.showAppBar()
      this.showComment()
    },

    methods: {
      showComment () {
        if (this.$route.name === 'post') {
          setTimeout(() => {this.commentBlock = true}, 3000)
        } else {
          this.commentBlock = false
        }
      },

      showAppBar () {
        if (window.scrollY === 0) {
          this.appBar = true
        }
      },

    }
  })
















</script>


 
</body>
</html>
